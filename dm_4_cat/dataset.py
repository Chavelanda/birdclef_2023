# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_dataset.ipynb.

# %% auto 0
__all__ = ['CATDataset', 'DatasetManager']

# %% ../nbs/01_dataset.ipynb 3
from torch.utils.data import Dataset, DataLoader

# %% ../nbs/01_dataset.ipynb 5
class CATDataset(Dataset):
    "Pytorch dataset to handle CAT scans data"
    
    def __init__(self):
        pass

    def __len__(self):
        pass

    def __getitem__(self):
        pass

# %% ../nbs/01_dataset.ipynb 8
class DatasetManager:
    "Manage your datasets through a dictionary containing pytorch dataset classes and their kwargs."

    def __init__(self) -> None:
        self.dataset_dict = {
            
        }

# %% ../nbs/01_dataset.ipynb 12
@patch
def get_dataset(self:DatasetManager,
                 dataset:str        # A key of the dataset dictionary
                )->Dataset:         # Pytorch dataset
    "A getter method to retrieve the wanted dataset."
    assert dataset in self.dataset_dict.keys(), f'{dataset} is not an existing dataset, choose one from {self.dataset_dict.keys()}.'
    ds_class, kwargs = self.dataset_dict[dataset]
    return ds_class(**kwargs)

# %% ../nbs/01_dataset.ipynb 15
@patch
def add_dataset(self:DatasetManager,
                dataset_key:str,        # The key to access the dataset
                dataset_class:Dataset,  # The class of the pytorch dataset 
                dataset_kwargs:dict):     # The parameters needed to instanciate the dataset
    "In order to use a different dataset it is possible to add it to the manager."
    self.dataset_dict[dataset_key] = (dataset_class, dataset_kwargs)

# %% ../nbs/01_dataset.ipynb 16
@patch
def get_dataloader(self:DatasetManager,
                dataset_key:str,            # The key to access the dataset
                dataloader_kwargs:dict      # The optional parameters for a pytorch dataloader
                )->DataLoader:              # Pytorch dataloader
    "A function to get a dataloader from a specific dataset"
    dataset = self.get_dataset(dataset_key)

    return DataLoader(dataset, **dataloader_kwargs)
